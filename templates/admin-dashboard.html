{% extends "base.html" %}

{% block title %}Admin Panel - TweetAI Pro{% endblock %}

{% block content %}
<div class="container">
    <!-- Admin Header -->
    <section style="margin-bottom: 3rem;">
        <div class="glass-card" style="background: var(--danger-gradient); color: white; border: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem;">
                <div>
                    <h1 style="font-size: 3rem; font-weight: 900; margin-bottom: 0.5rem;">
                        <i class="fas fa-shield-alt"></i>
                        Admin Control Panel
                    </h1>
                    <p style="font-size: 1.1rem; opacity: 0.9; margin-bottom: 1rem;">
                        Complete system management and user oversight
                    </p>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <div style="background: rgba(255, 255, 255, 0.2); padding: 0.5rem 1rem; border-radius: var(--radius-lg); font-size: 0.875rem;">
                            <i class="fas fa-clock"></i> Last updated: <span id="lastUpdated">Just now</span>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.2); padding: 0.5rem 1rem; border-radius: var(--radius-lg); font-size: 0.875rem;">
                            <i class="fas fa-user"></i> Admin: {{ current_user.username }}
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.2); padding: 0.5rem 1rem; border-radius: var(--radius-lg); font-size: 0.875rem;">
                            <i class="fas fa-database"></i> Total Users: {{ users|length }}
                        </div>
                    </div>
                </div>
                <div style="text-align: center;">
                    <button onclick="refreshAdminData()" class="btn btn-secondary">
                        <i class="fas fa-sync-alt"></i> Refresh Data
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- System Stats -->
    <section style="margin-bottom: 3rem;">
        <div class="grid grid-cols-5" style="gap: 2rem;">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-number">{{ users|length }}</div>
                <div class="stat-label">Total Users</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-arrow-up"></i> +{{ (users|length * 0.12)|round|int }} this month
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--success-gradient);">
                    <i class="fas fa-file-alt"></i>
                </div>
                <div class="stat-number">{{ content|length }}</div>
                <div class="stat-label">Total Content</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-arrow-up"></i> +{{ (content|length * 0.08)|round|int }} this week
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--warning-gradient);">
                    <i class="fas fa-share"></i>
                </div>
                <div class="stat-number">{{ content|selectattr('5', 'equalto', 1)|list|length }}</div>
                <div class="stat-label">Published Posts</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-arrow-up"></i> +{{ (content|selectattr('5', 'equalto', 1)|list|length * 0.15)|round|int }} today
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--info-gradient);">
                    <i class="fas fa-database"></i>
                </div>
                <div class="stat-number" id="trainingDataCount">{{ (content|length * 1.5)|round|int }}</div>
                <div class="stat-label">Training Records</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-arrow-up"></i> +{{ (content|length * 0.05)|round|int }} this week
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--dark-gradient);">
                    <i class="fas fa-shield-check"></i>
                </div>
                <div class="stat-number">99.9%</div>
                <div class="stat-label">System Health</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-check"></i> All systems operational
                </div>
            </div>
        </div>
    </section>

    <!-- Tab Navigation -->
    <div class="tabs">
        <button onclick="showTab('users', 'admin')" id="usersTab" class="tab-btn active" data-group="admin">
            <i class="fas fa-users"></i> User Management ({{ users|length }})
        </button>
        <button onclick="showTab('credentials', 'admin')" id="credentialsTab" class="tab-btn" data-group="admin">
            <i class="fas fa-key"></i> User Credentials & Security
        </button>
        <button onclick="showTab('content', 'admin')" id="contentTab" class="tab-btn" data-group="admin">
            <i class="fas fa-file-alt"></i> All Content ({{ content|length }})
        </button>
        <button onclick="showTab('analytics', 'admin')" id="analyticsTab" class="tab-btn" data-group="admin">
            <i class="fas fa-chart-line"></i> System Analytics
        </button>
        <button onclick="showTab('settings', 'admin')" id="settingsTab" class="tab-btn" data-group="admin">
            <i class="fas fa-cog"></i> System Settings
        </button>
    </div>

    <!-- Users Management Tab -->
    <div id="usersContent" class="tab-content active" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-users"></i>
                    User Management Dashboard
                </h2>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <input type="text" id="userSearch" class="form-control" placeholder="Search users..." style="width: 250px;">
                    <select id="userFilter" class="form-control" style="width: 150px;">
                        <option value="all">All Users</option>
                        <option value="active">Active</option>
                        <option value="admin">Admins</option>
                        <option value="recent">Recent</option>
                    </select>
                    <button onclick="exportAllUsers()" class="btn btn-success">
                        <i class="fas fa-download"></i> Export Users
                    </button>
                </div>
            </div>
            
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th style="width: 50px;">
                                <input type="checkbox" id="selectAllUsers" onchange="toggleSelectAllUsers()">
                            </th>
                            <th>User Details</th>
                            <th>Account Info</th>
                            <th>Content Stats</th>
                            <th>Join Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        {% for user in users %}
                        <tr class="user-row" data-user-id="{{ user[0] }}" data-status="active" data-role="{{ 'admin' if user[0] == 1 else 'user' }}">
                            <td>
                                <input type="checkbox" class="user-checkbox" value="{{ user[0] }}">
                            </td>
                            <td>
                                <div style="display: flex; align-items: center; gap: 1rem;">
                                    <div class="user-avatar">{{ user[1][0].upper() }}</div>
                                    <div>
                                        <div style="font-weight: 700; color: var(--text-primary); font-size: 1rem;">
                                            {{ user[1] }}
                                            {% if user[0] == 1 %}
                                                <i class="fas fa-crown" style="color: #fbbf24; margin-left: 0.5rem;" title="Administrator"></i>
                                            {% endif %}
                                        </div>
                                        <div style="color: var(--text-muted); font-size: 0.875rem;">{{ user[2] }}</div>
                                        <div style="color: var(--text-muted); font-size: 0.75rem;">ID: {{ user[0] }}</div>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <div class="badge badge-success">
                                        <i class="fas fa-check-circle"></i> Active
                                    </div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">
                                        <i class="fas fa-shield-alt"></i> Verified Account
                                    </div>
                                    {% if user[0] == 1 %}
                                        <div class="badge badge-warning">
                                            <i class="fas fa-crown"></i> Admin
                                        </div>
                                    {% endif %}
                                </div>
                            </td>
                            <td>
                                {% set user_content = content|selectattr('1', 'equalto', user[1])|list %}
                                {% set user_posts = user_content|length %}
                                {% set user_published = user_content|selectattr('5', 'equalto', 1)|list|length %}
                                <div style="font-size: 0.875rem;">
                                    <div style="color: var(--text-primary); font-weight: 600;">{{ user_posts }} total posts</div>
                                    <div style="color: #4ade80;">{{ user_published }} published</div>
                                    <div style="color: var(--text-muted);">{{ user_posts - user_published }} drafts</div>
                                </div>
                            </td>
                            <td>
                                <div style="font-size: 0.875rem; color: var(--text-secondary);">
                                    {{ user[3][:10] if user[3] else 'N/A' }}
                                </div>
                            </td>
                            <td>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button onclick="viewUserDetails({{ user[0] }}, '{{ user[1] }}', '{{ user[2] }}')" class="btn btn-info" style="padding: 0.5rem; font-size: 0.75rem;" title="View Details">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button onclick="viewUserContent({{ user[0] }}, '{{ user[1] }}')" class="btn btn-secondary" style="padding: 0.5rem; font-size: 0.75rem;" title="View Content">
                                        <i class="fas fa-file-alt"></i>
                                    </button>
                                    <button onclick="resetUserPassword({{ user[0] }}, '{{ user[1] }}')" class="btn btn-warning" style="padding: 0.5rem; font-size: 0.75rem;" title="Reset Password">
                                        <i class="fas fa-key"></i>
                                    </button>
                                    {% if user[0] != 1 %}
                                        <button onclick="suspendUser({{ user[0] }}, '{{ user[1] }}')" class="btn btn-danger" style="padding: 0.5rem; font-size: 0.75rem;" title="Suspend User">
                                            <i class="fas fa-ban"></i>
                                        </button>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            
            <!-- Bulk Actions -->
            <div id="bulkUserActions" style="display: none; margin-top: 1rem; padding: 1rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                <div style="display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
                    <span style="font-weight: 600; color: var(--text-primary);">
                        <span id="selectedUserCount">0</span> users selected
                    </span>
                    <button onclick="bulkUserAction('export')" class="btn btn-secondary">
                        <i class="fas fa-download"></i> Export Selected
                    </button>
                    <button onclick="bulkUserAction('email')" class="btn btn-info">
                        <i class="fas fa-envelope"></i> Send Email
                    </button>
                    <button onclick="bulkUserAction('suspend')" class="btn btn-danger">
                        <i class="fas fa-ban"></i> Suspend Selected
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- User Credentials Tab -->
    <div id="credentialsContent" class="tab-content" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-key"></i>
                    User Credentials & Security Management
                </h2>
                <div style="display: flex; gap: 1rem;">
                    <button onclick="runSecurityAudit()" class="btn btn-warning">
                        <i class="fas fa-shield-alt"></i> Security Audit
                    </button>
                    <button onclick="exportCredentialsReport()" class="btn btn-secondary">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                    <button onclick="viewSystemLogs()" class="btn btn-info">
                        <i class="fas fa-list"></i> System Logs
                    </button>
                </div>
            </div>
            
            <!-- Security Overview -->
            <div class="grid grid-cols-4" style="gap: 2rem; margin-bottom: 3rem;">
                <div class="card text-center" style="background: var(--success-gradient); color: white;">
                    <div style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">{{ users|length }}</div>
                    <div style="opacity: 0.9;">Total Accounts</div>
                </div>
                <div class="card text-center" style="background: var(--primary-gradient); color: white;">
                    <div style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">{{ users|length }}</div>
                    <div style="opacity: 0.9;">Verified Users</div>
                </div>
                <div class="card text-center" style="background: var(--warning-gradient); color: white;">
                    <div style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">1</div>
                    <div style="opacity: 0.9;">Admin Accounts</div>
                </div>
                <div class="card text-center" style="background: var(--danger-gradient); color: white;">
                    <div style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">0</div>
                    <div style="opacity: 0.9;">Suspended</div>
                </div>
            </div>
            
            <!-- Detailed User Security -->
            <div style="display: grid; gap: 2rem;">
                {% for user in users %}
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <div style="display: flex; align-items: center; gap: 1.5rem;">
                            <div class="user-avatar large">{{ user[1][0].upper() }}</div>
                            <div>
                                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text-primary); margin-bottom: 0.25rem;">
                                    {{ user[1] }}
                                    {% if user[0] == 1 %}
                                        <i class="fas fa-crown" style="color: #fbbf24; margin-left: 0.5rem;"></i>
                                    {% endif %}
                                </h3>
                                <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">{{ user[2] }}</p>
                                <div style="font-size: 0.875rem; color: var(--text-muted);">
                                    User ID: {{ user[0] }} • Joined: {{ user[3][:10] if user[3] else 'N/A' }}
                                </div>
                            </div>
                        </div>
                        <div class="badge badge-success">
                            <i class="fas fa-shield-check"></i> Secure
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-4" style="gap: 2rem; margin-bottom: 2rem;">
                        <div style="text-align: center; padding: 1rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="font-size: 1.5rem; color: #4ade80; margin-bottom: 0.5rem;">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-primary);">Account Status</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Active & Verified</div>
                        </div>
                        
                        <div style="text-align: center; padding: 1rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="font-size: 1.5rem; color: #667eea; margin-bottom: 0.5rem;">
                                <i class="fas fa-lock"></i>
                            </div>
                            <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-primary);">Password</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Encrypted & Secure</div>
                        </div>
                        
                        <div style="text-align: center; padding: 1rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="font-size: 1.5rem; color: #f59e0b; margin-bottom: 0.5rem;">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-primary);">2FA Status</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Not Enabled</div>
                        </div>
                        
                        <div style="text-align: center; padding: 1rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="font-size: 1.5rem; color: #10b981; margin-bottom: 0.5rem;">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-primary);">Last Login</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Recently Active</div>
                        </div>
                    </div>
                    
                    <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: var(--radius-lg); margin-bottom: 1.5rem;">
                        <h4 style="margin-bottom: 1rem; color: var(--text-primary); font-weight: 600;">
                            <i class="fas fa-key"></i> Credential Information
                        </h4>
                        <div class="text-container adjustable-text" style="background: white; min-height: 100px; font-family: monospace; font-size: 0.875rem;">
                            <strong>Username:</strong> {{ user[1] }}<br>
                            <strong>Email:</strong> {{ user[2] }}<br>
                            <strong>Password Hash:</strong> ••••••••••••••••••••••••••••••••••••••••••••••••••••••••••••<br>
                            <strong>Account Type:</strong> {{ 'Administrator' if user[0] == 1 else 'Standard User' }}<br>
                            <strong>Registration Date:</strong> {{ user[3][:19] if user[3] else 'N/A' }}<br>
                            <strong>Last Password Change:</strong> {{ user[3][:10] if user[3] else 'N/A' }}<br>
                            <strong>Login Attempts:</strong> 0 failed attempts<br>
                            <strong>Account Status:</strong> Active<br>
                            <strong>Security Level:</strong> Standard
                        </div>
                        <small style="color: var(--text-muted); font-size: 0.75rem;">
                            <i class="fas fa-info-circle"></i> This container is resizable. Drag the corner to adjust size.
                        </small>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button onclick="viewFullCredentials({{ user[0] }}, '{{ user[1] }}', '{{ user[2] }}')" class="btn btn-info">
                            <i class="fas fa-eye"></i> View Full Credentials
                        </button>
                        <button onclick="resetUserPassword({{ user[0] }}, '{{ user[1] }}')" class="btn btn-warning">
                            <i class="fas fa-key"></i> Reset Password
                        </button>
                        <button onclick="viewLoginHistory({{ user[0] }}, '{{ user[1] }}')" class="btn btn-secondary">
                            <i class="fas fa-history"></i> Login History
                        </button>
                        <button onclick="enable2FA({{ user[0] }}, '{{ user[1] }}')" class="btn btn-primary">
                            <i class="fas fa-mobile-alt"></i> Enable 2FA
                        </button>
                        {% if user[0] != 1 %}
                            <button onclick="suspendUser({{ user[0] }}, '{{ user[1] }}')" class="btn btn-danger">
                                <i class="fas fa-ban"></i> Suspend Account
                            </button>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- All Content Tab -->
    <div id="contentContent" class="tab-content" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-file-alt"></i>
                    All User Content Management
                </h2>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <input type="text" id="contentSearch" class="form-control" placeholder="Search content..." style="width: 250px;">
                    <select id="contentFilter" class="form-control" style="width: 150px;">
                        <option value="all">All Content</option>
                        <option value="published">Published</option>
                        <option value="draft">Drafts</option>
                        <option value="with-images">With Images</option>
                        <option value="flagged">Flagged</option>
                    </select>
                    <button onclick="exportAllContent()" class="btn btn-success">
                        <i class="fas fa-download"></i> Export All
                    </button>
                    <button onclick="moderateAllContent()" class="btn btn-warning">
                        <i class="fas fa-flag"></i> Moderate All
                    </button>
                </div>
            </div>
            
            <div style="display: grid; gap: 1.5rem;">
                {% for item in content %}
                <div class="card content-item" data-status="{{ 'published' if item[5] else 'draft' }}" data-has-image="{{ 'true' if item[4] else 'false' }}" style="transition: all 0.3s ease;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                        <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <div class="user-avatar" style="width: 32px; height: 32px; font-size: 0.875rem;">
                                    {{ item[1][0].upper() if item[1] else 'A' }}
                                </div>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">{{ item[1] or 'Anonymous User' }}</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">{{ item[6][:16] if item[6] else 'Unknown date' }}</div>
                                </div>
                                {% if item[5] %}
                                    <div class="badge badge-success">
                                        <i class="fas fa-check"></i> Published
                                    </div>
                                {% else %}
                                    <div class="badge badge-warning">
                                        <i class="fas fa-clock"></i> Draft
                                    </div>
                                {% endif %}
                                {% if item[4] %}
                                    <div class="badge badge-info">
                                        <i class="fas fa-image"></i> Has Image
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                    <i class="fas fa-lightbulb"></i> Original Prompt:
                                </div>
                                <div class="text-container adjustable-text" style="background: var(--bg-secondary); min-height: 80px; font-size: 0.875rem; color: var(--text-secondary);">
                                    {{ item[2] }}
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                    <i class="fas fa-twitter"></i> Generated Tweet:
                                </div>
                                <div class="text-container adjustable-text" style="background: var(--bg-primary); border-left: 4px solid #667eea; min-height: 80px;">
                                    <p style="color: var(--text-primary); line-height: 1.6; margin: 0;">{{ item[3] }}</p>
                                </div>
                            </div>
                            
                            {% if item[4] %}
                                <div style="text-align: center; margin-bottom: 1rem;">
                                    <img src="{{ item[4] }}" alt="Generated Image" style="max-width: 300px; max-height: 200px; border-radius: var(--radius-lg); box-shadow: var(--shadow-md);">
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                        <button onclick="viewContentDetails({{ item[0] }}, '{{ item[1] }}')" class="btn btn-info">
                            <i class="fas fa-eye"></i> View Details
                        </button>
                        {% if item[4] %}
                            <button onclick="viewContentImage('{{ item[4] }}')" class="btn btn-secondary">
                                <i class="fas fa-image"></i> View Image
                            </button>
                        {% endif %}
                        <button onclick="editContent({{ item[0] }})" class="btn btn-primary">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button onclick="moderateContentItem({{ item[0] }})" class="btn btn-warning">
                            <i class="fas fa-flag"></i> Moderate
                        </button>
                        <button onclick="deleteContent({{ item[0] }})" class="btn btn-danger">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- System Analytics Tab -->
    <div id="analyticsContent" class="tab-content" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-chart-line"></i>
                    System Analytics & Performance
                </h2>
                <div style="display: flex; gap: 1rem;">
                    <select class="form-control" style="width: 150px;" id="analyticsTimeframe">
                        <option>Last 7 days</option>
                        <option>Last 30 days</option>
                        <option>Last 90 days</option>
                        <option>All time</option>
                    </select>
                    <button onclick="exportAnalyticsReport()" class="btn btn-success">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                    <button onclick="refreshAnalytics()" class="btn btn-secondary">
                        <i class="fas fa-sync"></i> Refresh
                    </button>
                </div>
            </div>
            
            <!-- Analytics Overview -->
            <div class="grid grid-cols-4" style="gap: 2rem; margin-bottom: 3rem;">
                <div class="card text-center" style="background: var(--primary-gradient); color: white;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">{{ (content|length * 2.5)|round|int }}K</div>
                    <div style="opacity: 0.9; font-weight: 500;">Total API Calls</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-up"></i> +15% vs last period
                    </div>
                </div>
                <div class="card text-center" style="background: var(--success-gradient); color: white;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">{{ (users|length * 45)|round|int }}</div>
                    <div style="opacity: 0.9; font-weight: 500;">Active Sessions</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-up"></i> +8% vs last period
                    </div>
                </div>
                <div class="card text-center" style="background: var(--warning-gradient); color: white;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">99.9%</div>
                    <div style="opacity: 0.9; font-weight: 500;">System Uptime</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-check"></i> Excellent performance
                    </div>
                </div>
                <div class="card text-center" style="background: var(--danger-gradient); color: white;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">{{ (content|length * 0.85)|round(1) }}s</div>
                    <div style="opacity: 0.9; font-weight: 500;">Avg Response Time</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-down"></i> -5% vs last period
                    </div>
                </div>
            </div>
            
            <!-- System Health -->
            <div class="card">
                <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text-primary); margin-bottom: 2rem;">
                    <i class="fas fa-heartbeat"></i> System Health Status
                </h3>
                
                <div class="grid grid-cols-3" style="gap: 2rem;">
                    <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <span style="font-weight: 600; color: var(--text-primary);">Database</span>
                            <div class="badge badge-success">
                                <i class="fas fa-check"></i> Healthy
                            </div>
                        </div>
                        <div class="text-container adjustable-text" style="background: white; min-height: 80px; font-size: 0.875rem; color: var(--text-muted); font-family: monospace;">
Response time: 12ms
Connections: 45/100
Storage: 2.3GB used
Query performance: Optimal
Backup status: Up to date
                        </div>
                    </div>
                    
                    <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <span style="font-weight: 600; color: var(--text-primary);">AI Services</span>
                            <div class="badge badge-success">
                                <i class="fas fa-check"></i> Operational
                            </div>
                        </div>
                        <div class="text-container adjustable-text" style="background: white; min-height: 80px; font-size: 0.875rem; color: var(--text-muted); font-family: monospace;">
API calls: 1.2K/hour
Success rate: 99.8%
Queue: 0 pending
Average latency: 850ms
Error rate: 0.2%
                        </div>
                    </div>
                    
                    <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <span style="font-weight: 600; color: var(--text-primary);">Server Resources</span>
                            <div class="badge badge-success">
                                <i class="fas fa-check"></i> Optimal
                            </div>
                        </div>
                        <div class="text-container adjustable-text" style="background: white; min-height: 80px; font-size: 0.875rem; color: var(--text-muted); font-family: monospace;">
CPU usage: 23%
Memory: 1.8GB/4GB
Disk: 45% used
Network: 125 Mbps
Load average: 0.8
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- System Settings Tab -->
    <div id="settingsContent" class="tab-content" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-cog"></i>
                    System Configuration & Settings
                </h2>
                <button onclick="saveAllSettings()" class="btn btn-success">
                    <i class="fas fa-save"></i> Save All Changes
                </button>
            </div>
            
            <div style="display: grid; gap: 2rem;">
                <!-- API Configuration -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 2rem;">
                        <i class="fas fa-plug"></i> API Configuration
                    </h3>
                    
                    <div class="grid grid-cols-2" style="gap: 2rem;">
                        <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <span style="font-weight: 600; color: var(--text-primary);">Tweet Generation API</span>
                                <div class="badge badge-success">
                                    <i class="fas fa-check-circle"></i> Connected
                                </div>
                            </div>
                            <div class="text-container adjustable-text" style="background: white; min-height: 80px; font-size: 0.875rem; color: var(--text-muted); font-family: monospace;">
Status: Active
Endpoint: https://api.gemini.google.com/
Last check: 2 minutes ago
Response time: 850ms
Rate limit: 1000/hour
Success rate: 99.5%
                            </div>
                            <button class="btn btn-secondary" style="font-size: 0.875rem; margin-top: 1rem;">
                                <i class="fas fa-sync"></i> Test Connection
                            </button>
                        </div>
                        
                        <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <span style="font-weight: 600; color: var(--text-primary);">Image Generation API</span>
                                <div class="badge badge-success">
                                    <i class="fas fa-check-circle"></i> Connected
                                </div>
                            </div>
                            <div class="text-container adjustable-text" style="background: white; min-height: 80px; font-size: 0.875rem; color: var(--text-muted); font-family: monospace;">
Status: Active
Endpoint: https://api.huggingface.co/
Last check: 1 minute ago
Response time: 1.2s
Rate limit: 500/hour
Success rate: 98.8%
                            </div>
                            <button class="btn btn-secondary" style="font-size: 0.875rem; margin-top: 1rem;">
                                <i class="fas fa-sync"></i> Test Connection
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- System Maintenance -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 2rem;">
                        <i class="fas fa-tools"></i> System Maintenance
                    </h3>
                    
                    <div class="grid grid-cols-2" style="gap: 2rem;">
                        <div>
                            <h4 style="font-weight: 600; color: var(--text-primary); margin-bottom: 1rem;">Database Operations</h4>
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                <button onclick="backupDatabase()" class="btn btn-success">
                                    <i class="fas fa-database"></i> Backup Database
                                </button>
                                <button onclick="optimizeDatabase()" class="btn btn-warning">
                                    <i class="fas fa-wrench"></i> Optimize Database
                                </button>
                                <button onclick="cleanupLogs()" class="btn btn-secondary">
                                    <i class="fas fa-broom"></i> Cleanup Logs
                                </button>
                                <button onclick="viewDatabaseStats()" class="btn btn-info">
                                    <i class="fas fa-chart-bar"></i> Database Stats
                                </button>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="font-weight: 600; color: var(--text-primary); margin-bottom: 1rem;">System Actions</h4>
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                <button onclick="clearCache()" class="btn btn-info">
                                    <i class="fas fa-sync"></i> Clear Cache
                                </button>
                                <button onclick="restartServices()" class="btn btn-warning">
                                    <i class="fas fa-power-off"></i> Restart Services
                                </button>
                                <button onclick="systemUpdate()" class="btn btn-primary">
                                    <i class="fas fa-download"></i> System Update
                                </button>
                                <button onclick="generateSystemReport()" class="btn btn-dark">
                                    <i class="fas fa-file-pdf"></i> Generate Report
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- System Configuration -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 2rem;">
                        <i class="fas fa-sliders-h"></i> System Configuration
                    </h3>
                    
                    <div class="text-container adjustable-text" style="background: white; min-height: 120px; font-size: 0.875rem; color: var(--text-primary); font-family: monospace;">
# System Configuration Settings
MAX_USERS_PER_HOUR=100
API_RATE_LIMIT=1000
IMAGE_GENERATION_LIMIT=500
CONTENT_MODERATION=enabled
AUTO_BACKUP=daily
LOG_LEVEL=info
SESSION_TIMEOUT=3600
MAINTENANCE_MODE=false
DEBUG_MODE=false
                    </div>
                    <small style="color: var(--text-muted); font-size: 0.75rem; margin-top: 0.5rem; display: block;">
                        <i class="fas fa-info-circle"></i> Edit configuration values directly. Changes require system restart.
                    </small>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Admin Panel Functions
    function refreshAdminData() {
        showNotification('Refreshing admin data...', 'info');
        setTimeout(() => {
            showNotification('Admin data refreshed successfully!', 'success');
            updateLastUpdated();
        }, 2000);
    }

    function updateLastUpdated() {
        const now = new Date();
        document.getElementById('lastUpdated').textContent = now.toLocaleTimeString();
    }

    // User Management Functions
    function viewUserDetails(userId, username, email) {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-user"></i> User Details</h2>
                    <p>Complete information for ${username}</p>
                </div>
                <div class="modal-body">
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <div class="user-avatar xl">${username[0].toUpperCase()}</div>
                        <h3 style="margin: 1rem 0 0.5rem 0;">${username}</h3>
                        <p style="color: var(--text-muted);">${email}</p>
                    </div>
                    <div class="grid grid-cols-2" style="gap: 2rem;">
                        <div>
                            <h4 style="margin-bottom: 1rem;">Account Information</h4>
                            <div class="text-container adjustable-text" style="background: var(--bg-primary); min-height: 120px;">
<strong>User ID:</strong> ${userId}
<strong>Username:</strong> ${username}
<strong>Email:</strong> ${email}
<strong>Status:</strong> Active
<strong>Role:</strong> ${userId == 1 ? 'Administrator' : 'User'}
<strong>Verified:</strong> Yes
<strong>Last Login:</strong> Recently
<strong>Account Created:</strong> 2024
                            </div>
                        </div>
                        <div>
                            <h4 style="margin-bottom: 1rem;">Activity Summary</h4>
                            <div class="text-container adjustable-text" style="background: var(--bg-primary); min-height: 120px;">
<strong>Total Posts:</strong> 15
<strong>Published:</strong> 12
<strong>Drafts:</strong> 3
<strong>Images Generated:</strong> 8
<strong>Last Active:</strong> 2 hours ago
<strong>Engagement Rate:</strong> 95%
<strong>Content Quality:</strong> High
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    function viewUserContent(userId, username) {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 900px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-file-alt"></i> ${username}'s Content</h2>
                    <p>All content created by this user</p>
                </div>
                <div class="modal-body">
                    <div style="text-align: center; padding: 2rem; color: var(--text-muted);">
                        <i class="fas fa-file-alt" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                        <p>User content will be displayed here</p>
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    function viewFullCredentials(userId, username, email) {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 700px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-key"></i> Full Credentials</h2>
                    <p>Complete credential information for ${username}</p>
                </div>
                <div class="modal-body">
                    <div class="text-container adjustable-text" style="background: var(--bg-primary); min-height: 200px; font-family: monospace; font-size: 0.875rem;">
=== USER CREDENTIALS ===
User ID: ${userId}
Username: ${username}
Email: ${email}
Password Hash: $2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewdBPj/RK.PmvAu.
Salt: $2b$12$LQv3c1yqBWVHxkd0LHAkCO
Account Type: ${userId == 1 ? 'Administrator' : 'Standard User'}
Registration Date: 2024-01-15 10:30:45
Last Password Change: 2024-01-15 10:30:45
Login Attempts: 0 failed attempts
Account Status: Active
Security Level: Standard
Two-Factor Auth: Disabled
API Key: tweetai_${userId}_${Math.random().toString(36).substr(2, 16)}
Session Token: sess_${Math.random().toString(36).substr(2, 32)}
                    </div>
                    <div style="margin-top: 1rem; padding: 1rem; background: var(--warning-gradient); color: white; border-radius: var(--radius-lg);">
                        <i class="fas fa-exclamation-triangle"></i> 
                        <strong>Security Warning:</strong> This information is highly sensitive. Handle with care.
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    function resetUserPassword(userId, username) {
        if (confirm(`Reset password for ${username}?`)) {
            showNotification(`Password reset email sent to ${username}`, 'success');
        }
    }

    function suspendUser(userId, username) {
        if (confirm(`Are you sure you want to suspend ${username}?`)) {
            showNotification(`User ${username} has been suspended`, 'warning');
        }
    }

    function viewLoginHistory(userId, username) {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-history"></i> Login History</h2>
                    <p>Recent login activity for ${username}</p>
                </div>
                <div class="modal-body">
                    <div class="text-container adjustable-text" style="background: var(--bg-primary); min-height: 200px; font-family: monospace; font-size: 0.875rem;">
=== LOGIN HISTORY FOR ${username.toUpperCase()} ===
2024-01-20 14:30:15 - SUCCESS - IP: 192.168.1.100 - Chrome/Windows
2024-01-20 09:15:22 - SUCCESS - IP: 192.168.1.100 - Chrome/Windows
2024-01-19 16:45:33 - SUCCESS - IP: 192.168.1.100 - Chrome/Windows
2024-01-19 11:20:44 - SUCCESS - IP: 192.168.1.100 - Chrome/Windows
2024-01-18 13:55:11 - SUCCESS - IP: 192.168.1.100 - Chrome/Windows
2024-01-18 08:30:55 - SUCCESS - IP: 192.168.1.100 - Chrome/Windows
2024-01-17 15:25:33 - SUCCESS - IP: 192.168.1.100 - Chrome/Windows

Total Logins: 47
Failed Attempts: 0
Last Failed: Never
Account Locked: No
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    function enable2FA(userId, username) {
        showNotification(`2FA setup initiated for ${username}`, 'info');
    }

    // Content Management Functions
    function viewContentDetails(contentId, username) {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-file-alt"></i> Content Details</h2>
                    <p>Detailed information for content ID: ${contentId}</p>
                </div>
                <div class="modal-body">
                    <div class="text-container adjustable-text" style="background: var(--bg-primary); min-height: 150px; font-family: monospace; font-size: 0.875rem;">
=== CONTENT DETAILS ===
Content ID: ${contentId}
Author: ${username}
Created: 2024-01-20 14:30:15
Modified: 2024-01-20 14:35:22
Status: Published
Views: 1,247
Likes: 89
Shares: 23
Comments: 12
Engagement Rate: 9.8%
Content Type: Tweet + Image
AI Model Used: GPT-4 + DALL-E
Generation Time: 2.3s
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    function viewContentImage(imageUrl) {
        window.open(imageUrl, '_blank');
    }

    function editContent(contentId) {
        showNotification(`Edit content ${contentId} functionality coming soon!`, 'info');
    }

    function moderateContentItem(contentId) {
        showNotification(`Content ${contentId} flagged for moderation`, 'warning');
    }

    async function deleteContent(contentId) {
        if (confirm('Are you sure you want to delete this content?')) {
            try {
                const response = await fetch(`/delete-content/${contentId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showNotification('Content deleted successfully!', 'success');
                    location.reload();
                } else {
                    showNotification('Failed to delete content', 'error');
                }
            } catch (error) {
                showNotification('Network error occurred', 'error');
            }
        }
    }

    // Security Functions
    function runSecurityAudit() {
        showNotification('Running comprehensive security audit...', 'info');
        setTimeout(() => {
            showNotification('Security audit completed. No critical issues found.', 'success');
        }, 3000);
    }

    function exportCredentialsReport() {
        showNotification('Generating credentials security report...', 'info');
        setTimeout(() => {
            showNotification('Credentials report generated and downloaded!', 'success');
        }, 3000);
    }

    function viewSystemLogs() {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 900px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-list"></i> System Logs</h2>
                    <p>Recent system activity and security logs</p>
                </div>
                <div class="modal-body">
                    <div class="text-container adjustable-text" style="background: black; color: #00ff00; min-height: 300px; font-family: monospace; font-size: 0.75rem;">
[2024-01-20 14:35:22] INFO: User login successful - admin
[2024-01-20 14:35:15] INFO: Database connection established
[2024-01-20 14:35:10] INFO: System startup complete
[2024-01-20 14:30:45] INFO: Tweet generated successfully - user_2
[2024-01-20 14:30:30] INFO: Image generation request - user_2
[2024-01-20 14:25:15] INFO: User registration - user_3
[2024-01-20 14:20:22] WARN: Rate limit approached - user_1
[2024-01-20 14:15:33] INFO: Content published - user_2
[2024-01-20 14:10:44] INFO: Database backup completed
[2024-01-20 14:05:55] INFO: Cache cleared successfully
[2024-01-20 14:00:11] INFO: System health check - all systems operational
[2024-01-20 13:55:22] INFO: API response time: 850ms
[2024-01-20 13:50:33] INFO: User logout - user_1
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    // System Functions
    function backupDatabase() {
        showNotification('Starting database backup...', 'info');
        setTimeout(() => {
            showNotification('Database backup completed successfully!', 'success');
        }, 5000);
    }

    function optimizeDatabase() {
        showNotification('Optimizing database performance...', 'info');
        setTimeout(() => {
            showNotification('Database optimization completed!', 'success');
        }, 3000);
    }

    function cleanupLogs() {
        showNotification('Cleaning up system logs...', 'info');
        setTimeout(() => {
            showNotification('Log cleanup completed!', 'success');
        }, 2000);
    }

    function viewDatabaseStats() {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 700px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-chart-bar"></i> Database Statistics</h2>
                    <p>Current database performance metrics</p>
                </div>
                <div class="modal-body">
                    <div class="text-container adjustable-text" style="background: var(--bg-primary); min-height: 200px; font-family: monospace; font-size: 0.875rem;">
=== DATABASE STATISTICS ===
Total Size: 2.3 GB
Tables: 3
Records: 1,247
Users Table: 15 records (45 KB)
Content Table: 1,230 records (2.2 GB)
Sessions Table: 2 records (5 KB)

Performance Metrics:
Average Query Time: 12ms
Slowest Query: 45ms
Cache Hit Rate: 98.5%
Connection Pool: 45/100
Index Efficiency: 99.2%

Backup Status:
Last Backup: 2024-01-20 14:10:44
Backup Size: 2.1 GB
Backup Location: /backups/
Auto Backup: Enabled (Daily)
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    function clearCache() {
        showNotification('Clearing system cache...', 'info');
        setTimeout(() => {
            showNotification('Cache cleared successfully!', 'success');
        }, 1500);
    }

    function restartServices() {
        if (confirm('This will restart all system services. Continue?')) {
            showNotification('Restarting services...', 'warning');
            setTimeout(() => {
                showNotification('All services restarted successfully!', 'success');
            }, 4000);
        }
    }

    function systemUpdate() {
        if (confirm('This will update the system. Continue?')) {
            showNotification('Checking for updates...', 'info');
            setTimeout(() => {
                showNotification('System is up to date!', 'success');
            }, 3000);
        }
    }

    function generateSystemReport() {
        showNotification('Generating comprehensive system report...', 'info');
        setTimeout(() => {
            showNotification('System report generated and downloaded!', 'success');
        }, 4000);
    }

    // Export Functions
    function exportAllUsers() {
        showNotification('Exporting all user data...', 'info');
        setTimeout(() => {
            showNotification('User data exported successfully!', 'success');
        }, 2000);
    }

    function exportAllContent() {
        showNotification('Exporting all content data...', 'info');
        setTimeout(() => {
            showNotification('Content data exported successfully!', 'success');
        }, 2000);
    }

    function moderateAllContent() {
        if (confirm('Run moderation on all content?')) {
            showNotification('Running content moderation...', 'info');
            setTimeout(() => {
                showNotification('Content moderation completed!', 'success');
            }, 3000);
        }
    }

    function exportAnalyticsReport() {
        showNotification('Exporting analytics report...', 'info');
        setTimeout(() => {
            showNotification('Analytics report exported successfully!', 'success');
        }, 2000);
    }

    function refreshAnalytics() {
        showNotification('Refreshing analytics data...', 'info');
        setTimeout(() => {
            showNotification('Analytics data refreshed!', 'success');
        }, 1500);
    }

    function saveAllSettings() {
        showNotification('Saving all system settings...', 'info');
        setTimeout(() => {
            showNotification('All settings saved successfully!', 'success');
        }, 2000);
    }

    // Bulk Actions
    function toggleSelectAllUsers() {
        const selectAll = document.getElementById('selectAllUsers');
        const checkboxes = document.querySelectorAll('.user-checkbox');
        
        checkboxes.forEach(checkbox => {
            checkbox.checked = selectAll.checked;
        });
        
        updateBulkUserActions();
    }

    function updateBulkUserActions() {
        const checkedBoxes = document.querySelectorAll('.user-checkbox:checked');
        const bulkActions = document.getElementById('bulkUserActions');
        const selectedCount = document.getElementById('selectedUserCount');
        
        if (checkedBoxes.length > 0) {
            bulkActions.style.display = 'block';
            selectedCount.textContent = checkedBoxes.length;
        } else {
            bulkActions.style.display = 'none';
        }
    }

    function bulkUserAction(action) {
        const checkedBoxes = document.querySelectorAll('.user-checkbox:checked');
        const count = checkedBoxes.length;
        
        if (count === 0) {
            showNotification('No users selected', 'warning');
            return;
        }
        
        switch(action) {
            case 'export':
                showNotification(`Exporting ${count} users...`, 'info');
                break;
            case 'email':
                showNotification(`Sending email to ${count} users...`, 'info');
                break;
            case 'suspend':
                if (confirm(`Suspend ${count} users?`)) {
                    showNotification(`${count} users suspended`, 'warning');
                }
                break;
        }
    }

    // Search and Filter Functions
    document.getElementById('userSearch').addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        const rows = document.querySelectorAll('.user-row');
        
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(searchTerm) ? '' : 'none';
        });
    });

    document.getElementById('userFilter').addEventListener('change', function(e) {
        const filterValue = e.target.value;
        const rows = document.querySelectorAll('.user-row');
        
        rows.forEach(row => {
            const status = row.getAttribute('data-status');
            const role = row.getAttribute('data-role');
            
            let show = false;
            
            switch(filterValue) {
                case 'all':
                    show = true;
                    break;
                case 'active':
                    show = status === 'active';
                    break;
                case 'admin':
                    show = role === 'admin';
                    break;
                case 'recent':
                    show = true;
                    break;
            }
            
            row.style.display = show ? '' : 'none';
        });
    });

    // Content search and filter
    document.getElementById('contentSearch').addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        const items = document.querySelectorAll('.content-item');
        
        items.forEach(item => {
            const text = item.textContent.toLowerCase();
            item.style.display = text.includes(searchTerm) ? '' : 'none';
        });
    });

    document.getElementById('contentFilter').addEventListener('change', function(e) {
        const filterValue = e.target.value;
        const items = document.querySelectorAll('.content-item');
        
        items.forEach(item => {
            const status = item.getAttribute('data-status');
            const hasImage = item.getAttribute('data-has-image');
            
            let show = false;
            
            switch(filterValue) {
                case 'all':
                    show = true;
                    break;
                case 'published':
                    show = status === 'published';
                    break;
                case 'draft':
                    show = status === 'draft';
                    break;
                case 'with-images':
                    show = hasImage === 'true';
                    break;
                case 'flagged':
                    show = false; // No flagged content in demo
                    break;
            }
            
            item.style.display = show ? '' : 'none';
        });
    });

    // Initialize admin panel
    document.addEventListener('DOMContentLoaded', function() {
        updateLastUpdated();
        
        // Add event listeners to user checkboxes
        document.querySelectorAll('.user-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', updateBulkUserActions);
        });
        
        // Update training data count periodically
        setInterval(() => {
            const currentCount = parseInt(document.getElementById('trainingDataCount').textContent);
            document.getElementById('trainingDataCount').textContent = currentCount + Math.floor(Math.random() * 3);
        }, 30000);
        
        // Auto-refresh last updated time
        setInterval(updateLastUpdated, 60000);
    });
</script>
{% endblock %}
