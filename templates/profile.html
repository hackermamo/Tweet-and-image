{% extends "base.html" %}

{% block title %}Profile - TweetAI Pro{% endblock %}

{% block content %}
<div class="container">
    <!-- Profile Header -->
    <section style="margin-bottom: 3rem;">
        <div class="glass-card">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem;">
                <div style="display: flex; align-items: center; gap: 2rem;">
                    <div class="user-avatar xl">{{ current_user.username[0].upper() }}</div>
                    <div>
                        <h1 style="font-size: 2.5rem; font-weight: 800; color: var(--text-primary); margin-bottom: 0.5rem;">
                            {{ current_user.username }}
                        </h1>
                        <p style="color: var(--text-secondary); font-size: 1.1rem; margin-bottom: 1rem;">
                            {{ current_user.email }}
                        </p>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <div class="badge badge-success">
                                <i class="fas fa-check-circle"></i> Verified Account
                            </div>
                            <div class="badge badge-info">
                                <i class="fas fa-crown"></i> Pro Member
                            </div>
                            {% if current_user.is_admin %}
                                <div class="badge badge-warning">
                                    <i class="fas fa-shield-alt"></i> Administrator
                                </div>
                            {% endif %}
                            <div class="badge badge-success">
                                <i class="fas fa-calendar"></i> Member since 2024
                            </div>
                        </div>
                    </div>
                </div>
                <div style="text-align: center;">
                    <button onclick="openEditProfileModal()" class="btn btn-primary">
                        <i class="fas fa-edit"></i> Edit Profile
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Profile Stats -->
    <section style="margin-bottom: 3rem;">
        <div class="grid grid-cols-4" style="gap: 2rem;">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-file-alt"></i>
                </div>
                <div class="stat-number">{{ content|length if content else 0 }}</div>
                <div class="stat-label">Total Content</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--success-gradient);">
                    <i class="fas fa-share"></i>
                </div>
                <div class="stat-number">{{ content|selectattr('3', 'equalto', 1)|list|length if content else 0 }}</div>
                <div class="stat-label">Published Posts</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--warning-gradient);">
                    <i class="fas fa-image"></i>
                </div>
                <div class="stat-number">{{ content|selectattr('2')|list|length if content else 0 }}</div>
                <div class="stat-label">Images Generated</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--danger-gradient);">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="stat-number">{{ ((content|selectattr('3', 'equalto', 1)|list|length / content|length * 100) if content and content|length > 0 else 0)|round(1) }}%</div>
                <div class="stat-label">Success Rate</div>
            </div>
        </div>
    </section>

    <!-- Tab Navigation -->
    <div class="tabs">
        <button onclick="showTab('content', 'profile')" id="contentTab" class="tab-btn active" data-group="profile">
            <i class="fas fa-file-alt"></i> My Content ({{ content|length if content else 0 }})
        </button>
        <button onclick="showTab('analytics', 'profile')" id="analyticsTab" class="tab-btn" data-group="profile">
            <i class="fas fa-chart-bar"></i> Analytics
        </button>
        <button onclick="showTab('settings', 'profile')" id="settingsTab" class="tab-btn" data-group="profile">
            <i class="fas fa-cog"></i> Settings
        </button>
        <button onclick="showTab('billing', 'profile')" id="billingTab" class="tab-btn" data-group="profile">
            <i class="fas fa-credit-card"></i> Billing
        </button>
    </div>

    <!-- Content Tab -->
    <div id="contentContent" class="tab-content active" data-group="profile">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-file-alt"></i>
                    Your Generated Content
                </h2>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <select id="contentFilter" class="form-control" style="width: auto;">
                        <option value="all">All Content</option>
                        <option value="published">Published</option>
                        <option value="draft">Drafts</option>
                        <option value="with-images">With Images</option>
                    </select>
                    <a href="/dashboard" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Create New
                    </a>
                </div>
            </div>
            
            {% if content %}
                <div id="contentGrid" style="display: grid; gap: 2rem;">
                    {% for item in content %}
                    <div class="content-item card" data-status="{{ 'published' if item[3] else 'draft' }}" data-has-image="{{ 'true' if item[2] else 'false' }}" style="transition: all 0.3s ease;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                    <h3 style="color: var(--text-primary); font-size: 1.1rem; font-weight: 600; margin: 0;">
                                        {{ item[0][:60] }}{% if item[0]|length > 60 %}...{% endif %}
                                    </h3>
                                    {% if item[3] %}
                                        <div class="badge badge-success">
                                            <i class="fas fa-check"></i> Published
                                        </div>
                                    {% else %}
                                        <div class="badge badge-warning">
                                            <i class="fas fa-clock"></i> Draft
                                        </div>
                                    {% endif %}
                                </div>
                                <p style="color: var(--text-muted); font-size: 0.875rem; margin-bottom: 1rem;">
                                    Created on {{ item[4][:10] if item[4] else 'Unknown date' }}
                                </p>
                            </div>
                            <div style="display: flex; gap: 0.5rem;">
                                <button onclick="viewFullContent('{{ item[1] }}', '{{ item[2] if item[2] else '' }}')" class="btn btn-secondary" style="padding: 0.5rem;">
                                    <i class="fas fa-eye"></i>
                                </button>
                                {% if item[2] %}
                                    <button onclick="viewContentImage('{{ item[2] }}')" class="btn btn-secondary" style="padding: 0.5rem;">
                                        <i class="fas fa-image"></i>
                                    </button>
                                {% endif %}
                                <button onclick="shareContent('{{ item[1] }}')" class="btn btn-secondary" style="padding: 0.5rem;">
                                    <i class="fas fa-share"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: 12px; margin-bottom: 1rem;">
                            <p style="color: var(--text-primary); line-height: 1.6; margin: 0;">
                                {{ item[1] }}
                            </p>
                        </div>
                        
                        {% if item[2] %}
                            <div style="text-align: center; margin-bottom: 1rem;">
                                <img src="{{ item[2] }}" alt="Generated Image" style="max-width: 100%; max-height: 200px; border-radius: 12px; box-shadow: var(--shadow-md);">
                            </div>
                        {% endif %}
                        
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button onclick="copyToClipboard('{{ item[1] }}')" class="btn btn-secondary">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            {% if not item[3] %}
                                <button onclick="publishContent('{{ item[0] }}')" class="btn btn-success">
                                    <i class="fas fa-paper-plane"></i> Publish
                                </button>
                            {% endif %}
                            <button onclick="editContent('{{ item[0] }}')" class="btn btn-warning">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div style="text-align: center; padding: 4rem; color: var(--text-muted);">
                    <div style="font-size: 4rem; margin-bottom: 2rem; opacity: 0.3;">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <h3 style="font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem;">No content yet</h3>
                    <p style="margin-bottom: 2rem; max-width: 400px; margin-left: auto; margin-right: auto;">
                        Start creating amazing content with our AI-powered tools. Your generated tweets and images will appear here.
                    </p>
                    <a href="/dashboard" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Create Your First Tweet
                    </a>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Analytics Tab -->
    <div id="analyticsContent" class="tab-content" data-group="profile">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-chart-bar"></i>
                    Performance Analytics
                </h2>
                <div class="badge badge-info">
                    <i class="fas fa-clock"></i> Last 30 days
                </div>
            </div>
            
            <!-- Analytics Overview -->
            <div class="grid grid-cols-4" style="gap: 2rem; margin-bottom: 3rem;">
                <div style="background: var(--success-gradient); color: white; padding: 2rem; border-radius: 16px; text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">{{ content|length if content else 0 }}</div>
                    <div style="opacity: 0.9; font-weight: 500;">Total Posts</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-up"></i> +12% vs last month
                    </div>
                </div>
                <div style="background: var(--primary-gradient); color: white; padding: 2rem; border-radius: 16px; text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">1.2K</div>
                    <div style="opacity: 0.9; font-weight: 500;">Total Views</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-up"></i> +8% vs last month
                    </div>
                </div>
                <div style="background: var(--warning-gradient); color: white; padding: 2rem; border-radius: 16px; text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">89%</div>
                    <div style="opacity: 0.9; font-weight: 500;">Engagement Rate</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-up"></i> +15% vs last month
                    </div>
                </div>
                <div style="background: var(--danger-gradient); color: white; padding: 2rem; border-radius: 16px; text-align: center;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">+25%</div>
                    <div style="opacity: 0.9; font-weight: 500;">Growth Rate</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-up"></i> +5% vs last month
                    </div>
                </div>
            </div>
            
            <!-- Performance Chart Placeholder -->
            <div style="background: var(--bg-primary); padding: 4rem; border-radius: 16px; text-align: center; margin-bottom: 3rem;">
                <div style="font-size: 4rem; color: var(--text-muted); margin-bottom: 2rem; opacity: 0.3;">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h3 style="color: var(--text-secondary); font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem;">Performance Chart</h3>
                <p style="color: var(--text-muted); max-width: 400px; margin: 0 auto;">
                    Detailed analytics charts and insights will be available in the next update. Track your content performance over time.
                </p>
            </div>
            
            <!-- Top Performing Content -->
            <div>
                <h3 style="color: var(--text-primary); font-size: 1.5rem; font-weight: 700; margin-bottom: 2rem;">
                    <i class="fas fa-trophy"></i> Top Performing Content
                </h3>
                {% if content %}
                    <div style="display: grid; gap: 1rem;">
                        {% for item in content[:5] %}
                        <div style="display: flex; align-items: center; gap: 1.5rem; padding: 1.5rem; background: var(--bg-primary); border-radius: 16px; transition: all 0.3s ease;" onmouseover="this.style.transform='translateY(-2px)'" onmouseout="this.style.transform='translateY(0)'">
                            <div style="width: 50px; height: 50px; background: var(--primary-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 1.25rem;">
                                {{ loop.index }}
                            </div>
                            <div style="flex: 1;">
                                <div style="font-weight: 600; color: var(--text-primary); margin-bottom: 0.5rem; line-height: 1.4;">
                                    {{ item[1][:80] }}{% if item[1]|length > 80 %}...{% endif %}
                                </div>
                                <div style="font-size: 0.875rem; color: var(--text-muted);">
                                    {{ item[4][:10] if item[4] else 'Unknown date' }}
                                </div>
                            </div>
                            <div style="text-align: right;">
                                <div style="font-weight: 700; color: var(--success-gradient); font-size: 1.1rem;">{{ (loop.index * 47) }} views</div>
                                <div style="font-size: 0.875rem; color: var(--text-muted);">{{ (loop.index * 12) }} likes</div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                {% else %}
                    <div style="text-align: center; padding: 3rem; color: var(--text-muted);">
                        <div style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <p>No content available for analysis. Create some content to see performance insights.</p>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Settings Tab -->
    <div id="settingsContent" class="tab-content" data-group="profile">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-cog"></i>
                    Account Settings
                </h2>
            </div>
            
            <div style="display: grid; gap: 2rem;">
                <!-- Profile Settings -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem;">
                        <i class="fas fa-user"></i> Profile Information
                    </h3>
                    <div style="display: grid; gap: 1.5rem;">
                        <div class="form-group">
                            <label class="form-label">Username</label>
                            <input type="text" class="form-control" value="{{ current_user.username }}" readonly>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email Address</label>
                            <input type="email" class="form-control" value="{{ current_user.email }}" readonly>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Bio</label>
                            <textarea class="form-control" rows="3" placeholder="Tell us about yourself..."></textarea>
                        </div>
                        <button class="btn btn-primary" style="width: fit-content;">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </div>
                
                <!-- Security Settings -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem;">
                        <i class="fas fa-shield-alt"></i> Security & Privacy
                    </h3>
                    <div style="display: grid; gap: 1.5rem;">
                        <button class="btn btn-secondary" style="width: fit-content;">
                            <i class="fas fa-key"></i> Change Password
                        </button>
                        <button class="btn btn-secondary" style="width: fit-content;">
                            <i class="fas fa-mobile-alt"></i> Enable Two-Factor Authentication
                        </button>
                        <button class="btn btn-secondary" style="width: fit-content;">
                            <i class="fas fa-download"></i> Download My Data
                        </button>
                    </div>
                </div>
                
                <!-- Preferences -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem;">
                        <i class="fas fa-sliders-h"></i> Preferences
                    </h3>
                    <div style="display: grid; gap: 1.5rem;">
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--bg-primary); border-radius: 12px;">
                            <div>
                                <div style="font-weight: 600; color: var(--text-primary);">Email Notifications</div>
                                <div style="font-size: 0.875rem; color: var(--text-muted);">Receive updates about your account and content</div>
                            </div>
                            <label style="position: relative; display: inline-block; width: 60px; height: 34px;">
                                <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #667eea; transition: .4s; border-radius: 34px;"></span>
                                <span style="position: absolute; content: ''; height: 26px; width: 26px; left: 4px; bottom: 4px; background: white; transition: .4s; border-radius: 50%;"></span>
                            </label>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--bg-primary); border-radius: 12px;">
                            <div>
                                <div style="font-weight: 600; color: var(--text-primary);">Auto-save Drafts</div>
                                <div style="font-size: 0.875rem; color: var(--text-muted);">Automatically save your work as you type</div>
                            </div>
                            <label style="position: relative; display: inline-block; width: 60px; height: 34px;">
                                <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #667eea; transition: .4s; border-radius: 34px;"></span>
                                <span style="position: absolute; content: ''; height: 26px; width: 26px; left: 4px; bottom: 4px; background: white; transition: .4s; border-radius: 50%;"></span>
                            </label>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--bg-primary); border-radius: 12px;">
                            <div>
                                <div style="font-weight: 600; color: var(--text-primary);">AI Suggestions</div>
                                <div style="font-size: 0.875rem; color: var(--text-muted);">Get AI-powered content suggestions</div>
                            </div>
                            <label style="position: relative; display: inline-block; width: 60px; height: 34px;">
                                <input type="checkbox" checked style="opacity: 0; width: 0; height: 0;">
                                <span style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #667eea; transition: .4s; border-radius: 34px;"></span>
                                <span style="position: absolute; content: ''; height: 26px; width: 26px; left: 4px; bottom: 4px; background: white; transition: .4s; border-radius: 50%;"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Billing Tab -->
    <div id="billingContent" class="tab-content" data-group="profile">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-credit-card"></i>
                    Billing & Subscription
                </h2>
                <div class="badge badge-success">
                    <i class="fas fa-crown"></i> Pro Plan
                </div>
            </div>
            
            <div style="display: grid; gap: 2rem;">
                <!-- Current Plan -->
                <div class="card" style="background: var(--primary-gradient); color: white;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <div>
                            <h3 style="font-size: 1.5rem; font-weight: 700; margin-bottom: 0.5rem;">TweetAI Pro</h3>
                            <p style="opacity: 0.9;">Unlimited AI generations and premium features</p>
                        </div>
                        <div style="text-align: right;">
                            <div style="font-size: 2rem; font-weight: 800;">$29</div>
                            <div style="opacity: 0.8; font-size: 0.875rem;">per month</div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-cols-2; gap: 1rem; margin-bottom: 2rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-check-circle"></i>
                            <span>Unlimited AI generations</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-check-circle"></i>
                            <span>Advanced image generation</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-check-circle"></i>
                            <span>Priority support</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 0.5rem;">
                            <i class="fas fa-check-circle"></i>
                            <span>Analytics & insights</span>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem;">
                        <button class="btn btn-secondary">
                            <i class="fas fa-edit"></i> Manage Plan
                        </button>
                        <button class="btn btn-secondary">
                            <i class="fas fa-times"></i> Cancel Subscription
                        </button>
                    </div>
                </div>
                
                <!-- Billing History -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem;">
                        <i class="fas fa-history"></i> Billing History
                    </h3>
                    
                    <div class="table-container">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Description</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                    <th>Invoice</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Jan 1, 2024</td>
                                    <td>TweetAI Pro - Monthly</td>
                                    <td>$29.00</td>
                                    <td><span class="badge badge-success">Paid</span></td>
                                    <td><button class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;"><i class="fas fa-download"></i></button></td>
                                </tr>
                                <tr>
                                    <td>Dec 1, 2023</td>
                                    <td>TweetAI Pro - Monthly</td>
                                    <td>$29.00</td>
                                    <td><span class="badge badge-success">Paid</span></td>
                                    <td><button class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;"><i class="fas fa-download"></i></button></td>
                                </tr>
                                <tr>
                                    <td>Nov 1, 2023</td>
                                    <td>TweetAI Pro - Monthly</td>
                                    <td>$29.00</td>
                                    <td><span class="badge badge-success">Paid</span></td>
                                    <td><button class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;"><i class="fas fa-download"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Payment Method -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 1.5rem;">
                        <i class="fas fa-credit-card"></i> Payment Method
                    </h3>
                    
                    <div style="display: flex; align-items: center; gap: 1rem; padding: 1.5rem; background: var(--bg-primary); border-radius: 12px; margin-bottom: 1.5rem;">
                        <div style="width: 50px; height: 32px; background: #1a1f71; border-radius: 6px; display: flex; align-items: center; justify-content: center; color: white; font-weight: 700; font-size: 0.75rem;">
                            VISA
                        </div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: var(--text-primary);">•••• •••• •••• 4242</div>
                            <div style="font-size: 0.875rem; color: var(--text-muted);">Expires 12/25</div>
                        </div>
                        <button class="btn btn-secondary">
                            <i class="fas fa-edit"></i> Update
                        </button>
                    </div>
                    
                    <button class="btn btn-primary" style="width: fit-content;">
                        <i class="fas fa-plus"></i> Add Payment Method
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Content Functions
    function viewFullContent(tweet, imageUrl) {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 700px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-eye"></i> Full Content View</h2>
                    <p>Complete generated content with details</p>
                </div>
                <div class="modal-body">
                    <div style="background: var(--bg-primary); padding: 2rem; border-radius: 16px; margin-bottom: 1.5rem; border-left: 4px solid #667eea;">
                        <p style="color: var(--text-primary); line-height: 1.6; margin: 0; font-size: 1.1rem;">${tweet}</p>
                    </div>
                    ${imageUrl ? `
                        <div style="text-align: center; margin-bottom: 1.5rem;">
                            <img src="${imageUrl}" alt="Generated Image" style="max-width: 100%; border-radius: 16px; box-shadow: var(--shadow-lg);">
                        </div>
                    ` : ''}
                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                        <button onclick="copyToClipboard('${tweet}')" class="btn btn-secondary">
                            <i class="fas fa-copy"></i> Copy Text
                        </button>
                        <button onclick="shareContent('${tweet}')" class="btn btn-secondary">
                            <i class="fas fa-share"></i> Share
                        </button>
                        ${imageUrl ? `<button onclick="window.open('${imageUrl}', '_blank')" class="btn btn-secondary"><i class="fas fa-external-link-alt"></i> Open Image</button>` : ''}
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    function viewContentImage(imageUrl) {
        window.open(imageUrl, '_blank');
    }

    function shareContent(content) {
        if (navigator.share) {
            navigator.share({
                title: 'Check out this AI-generated content!',
                text: content,
                url: window.location.href
            });
        } else {
            copyToClipboard(content);
        }
    }

    function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
            showNotification('Content copied to clipboard!', 'success');
        }).catch(() => {
            showNotification('Failed to copy content', 'error');
        });
    }

    function publishContent(contentId) {
        showNotification('Publishing content...', 'info');
        // Simulate API call
        setTimeout(() => {
            showNotification('Content published successfully!', 'success');
            location.reload();
        }, 2000);
    }

    function editContent(contentId) {
        showNotification('Edit functionality coming soon!', 'info');
    }

    function openEditProfileModal() {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-edit"></i> Edit Profile</h2>
                    <p>Update your profile information</p>
                </div>
                <div class="modal-body">
                    <form id="editProfileForm">
                        <div class="form-group">
                            <label class="form-label">Display Name</label>
                            <input type="text" class="form-control" value="{{ current_user.username }}" placeholder="Your display name">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Bio</label>
                            <textarea class="form-control" rows="3" placeholder="Tell us about yourself..."></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Website</label>
                            <input type="url" class="form-control" placeholder="https://your-website.com">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location</label>
                            <input type="text" class="form-control" placeholder="Your location">
                        </div>
                        <button type="submit" class="btn btn-primary w-full">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </form>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
        
        modal.querySelector('#editProfileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            showNotification('Profile updated successfully!', 'success');
            modal.remove();
        });
    }

    // Content Filter
    document.getElementById('contentFilter').addEventListener('change', function(e) {
        const filterValue = e.target.value;
        const items = document.querySelectorAll('.content-item');
        
        items.forEach(item => {
            const status = item.getAttribute('data-status');
            const hasImage = item.getAttribute('data-has-image');
            
            let show = false;
            
            switch(filterValue) {
                case 'all':
                    show = true;
                    break;
                case 'published':
                    show = status === 'published';
                    break;
                case 'draft':
                    show = status === 'draft';
                    break;
                case 'with-images':
                    show = hasImage === 'true';
                    break;
            }
            
            item.style.display = show ? 'block' : 'none';
        });
    });

    // Initialize profile page
    document.addEventListener('DOMContentLoaded', function() {
        // Add hover effects to content items
        document.querySelectorAll('.content-item').forEach(item => {
            item.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-4px)';
                this.style.boxShadow = 'var(--shadow-xl)';
            });
            
            item.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
                this.style.boxShadow = 'var(--shadow-lg)';
            });
        });
    });
</script>
{% endblock %}
