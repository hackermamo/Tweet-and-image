{% extends "base.html" %}

{% block title %}Admin Panel - TweetAI Pro{% endblock %}

{% block content %}
<div class="container">
    <!-- Admin Header -->
    <section style="margin-bottom: 3rem;">
        <div class="glass-card" style="background: var(--danger-gradient); color: white; border: none;">
            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 2rem; padding: 1rem;">
                <div>
                    <h1 style="font-size: 3rem; font-weight: 900; margin-bottom: 0.5rem;">
                        <i class="fas fa-shield-alt"></i>
                        Admin Control Panel
                    </h1>
                    <p style="font-size: 1.1rem; opacity: 0.9; margin-bottom: 1rem;">
                        Complete system management and user oversight
                    </p>
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <div style="background: rgba(255, 255, 255, 0.2); padding: 0.5rem 1rem; border-radius: var(--radius-lg); font-size: 0.875rem;">
                            <i class="fas fa-clock"></i> Last updated: <span id="lastUpdated">Just now</span>
                        </div>
                        <div style="background: rgba(255, 255, 255, 0.2); padding: 0.5rem 1rem; border-radius: var(--radius-lg); font-size: 0.875rem;">
                            <i class="fas fa-user"></i> Admin: {{ current_user.username }}
                        </div>
                    </div>
                </div>
                <div style="text-align: center;">
                    <button onclick="refreshData()" class="btn btn-secondary">
                        <i class="fas fa-sync-alt"></i> Refresh Data
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- System Stats -->
    <section style="margin-bottom: 3rem;">
        <div class="grid grid-cols-5" style="gap: 2rem;">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-number">{{ users|length }}</div>
                <div class="stat-label">Total Users</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-arrow-up"></i> +{{ (users|length * 0.12)|round|int }} this month
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--success-gradient);">
                    <i class="fas fa-file-alt"></i>
                </div>
                <div class="stat-number">{{ content|length }}</div>
                <div class="stat-label">Total Content</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-arrow-up"></i> +{{ (content|length * 0.08)|round|int }} this week
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--warning-gradient);">
                    <i class="fas fa-share"></i>
                </div>
                <div class="stat-number">{{ content|selectattr('5', 'equalto', 1)|list|length }}</div>
                <div class="stat-label">Published Posts</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-arrow-up"></i> +{{ (content|selectattr('5', 'equalto', 1)|list|length * 0.15)|round|int }} today
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--info-gradient);">
                    <i class="fas fa-database"></i>
                </div>
                <div class="stat-number" id="trainingDataCount">{{ (content|length * 1.5)|round|int }}</div>
                <div class="stat-label">Training Records</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-arrow-up"></i> +{{ (content|length * 0.05)|round|int }} this week
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon" style="background: var(--dark-gradient);">
                    <i class="fas fa-shield-check"></i>
                </div>
                <div class="stat-number">99.9%</div>
                <div class="stat-label">System Health</div>
                <div style="font-size: 0.75rem; color: #4ade80; margin-top: 0.5rem;">
                    <i class="fas fa-check"></i> All systems operational
                </div>
            </div>
        </div>
    </section>

    <!-- Tab Navigation -->
    <div class="tabs">
        <button onclick="showTab('users', 'admin')" id="usersTab" class="tab-btn active" data-group="admin">
            <i class="fas fa-users"></i> User Management ({{ users|length }})
        </button>
        <button onclick="showTab('credentials', 'admin')" id="credentialsTab" class="tab-btn" data-group="admin">
            <i class="fas fa-key"></i> User Credentials & Security
        </button>
        <button onclick="showTab('content', 'admin')" id="contentTab" class="tab-btn" data-group="admin">
            <i class="fas fa-file-alt"></i> Content Management ({{ content|length }})
        </button>
        <button onclick="showTab('analytics', 'admin')" id="analyticsTab" class="tab-btn" data-group="admin">
            <i class="fas fa-chart-line"></i> System Analytics
        </button>
        <button onclick="showTab('settings', 'admin')" id="settingsTab" class="tab-btn" data-group="admin">
            <i class="fas fa-cog"></i> System Settings
        </button>
    </div>

    <!-- Users Management Tab -->
    <div id="usersContent" class="tab-content active" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-users"></i>
                    User Management Dashboard
                </h2>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <input type="text" id="userSearch" class="form-control" placeholder="Search users..." style="width: 250px;">
                    <select id="userFilter" class="form-control" style="width: 150px;">
                        <option value="all">All Users</option>
                        <option value="active">Active</option>
                        <option value="admin">Admins</option>
                        <option value="recent">Recent</option>
                    </select>
                    <button onclick="exportUsers()" class="btn btn-success">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
            
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th style="width: 50px;">
                                <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                            </th>
                            <th>User Details</th>
                            <th>Account Info</th>
                            <th>Activity Stats</th>
                            <th>Join Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        {% for user in users %}
                        <tr class="user-row" data-user-id="{{ user[0] }}" data-status="active" data-role="{{ 'admin' if user[0] == 1 else 'user' }}">
                            <td>
                                <input type="checkbox" class="user-checkbox" value="{{ user[0] }}">
                            </td>
                            <td>
                                <div style="display: flex; align-items: center; gap: 1rem;">
                                    <div class="user-avatar">{{ user[1][0].upper() }}</div>
                                    <div>
                                        <div style="font-weight: 700; color: var(--text-primary); font-size: 1rem;">
                                            {{ user[1] }}
                                            {% if user[0] == 1 %}
                                                <i class="fas fa-crown" style="color: #fbbf24; margin-left: 0.5rem;" title="Administrator"></i>
                                            {% endif %}
                                        </div>
                                        <div style="color: var(--text-muted); font-size: 0.875rem;">{{ user[2] }}</div>
                                        <div style="color: var(--text-muted); font-size: 0.75rem;">ID: {{ user[0] }}</div>
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div style="display: flex; flex-direction: column; gap: 0.5rem;">
                                    <div class="badge badge-success">
                                        <i class="fas fa-check-circle"></i> Active
                                    </div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">
                                        <i class="fas fa-shield-alt"></i> Verified Account
                                    </div>
                                    {% if user[0] == 1 %}
                                        <div class="badge badge-warning">
                                            <i class="fas fa-crown"></i> Admin
                                        </div>
                                    {% endif %}
                                </div>
                            </td>
                            <td>
                                {% set user_content = content|selectattr('1', 'equalto', user[1])|list %}
                                {% set user_posts = user_content|length %}
                                {% set user_published = user_content|selectattr('5', 'equalto', 1)|list|length %}
                                <div style="font-size: 0.875rem;">
                                    <div style="color: var(--text-primary); font-weight: 600;">{{ user_posts }} total posts</div>
                                    <div style="color: #4ade80;">{{ user_published }} published</div>
                                    <div style="color: var(--text-muted);">{{ user_posts - user_published }} drafts</div>
                                </div>
                            </td>
                            <td>
                                <div style="font-size: 0.875rem; color: var(--text-secondary);">
                                    {{ user[3][:10] if user[3] else 'N/A' }}
                                </div>
                            </td>
                            <td>
                                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <button onclick="viewUserDetails({{ user[0] }})" class="btn btn-info" style="padding: 0.5rem; font-size: 0.75rem;" title="View Details">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button onclick="editUser({{ user[0] }})" class="btn btn-warning" style="padding: 0.5rem; font-size: 0.75rem;" title="Edit User">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="resetUserPassword({{ user[0] }})" class="btn btn-secondary" style="padding: 0.5rem; font-size: 0.75rem;" title="Reset Password">
                                        <i class="fas fa-key"></i>
                                    </button>
                                    {% if user[0] != 1 %}
                                        <button onclick="suspendUser({{ user[0] }})" class="btn btn-danger" style="padding: 0.5rem; font-size: 0.75rem;" title="Suspend User">
                                            <i class="fas fa-ban"></i>
                                        </button>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- User Credentials Tab -->
    <div id="credentialsContent" class="tab-content" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-key"></i>
                    User Credentials & Security Management
                </h2>
                <div style="display: flex; gap: 1rem;">
                    <button onclick="securityAudit()" class="btn btn-warning">
                        <i class="fas fa-shield-alt"></i> Security Audit
                    </button>
                    <button onclick="exportCredentials()" class="btn btn-secondary">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                </div>
            </div>
            
            <!-- Security Overview -->
            <div class="grid grid-cols-4" style="gap: 2rem; margin-bottom: 3rem;">
                <div class="card text-center" style="background: var(--success-gradient); color: white;">
                    <div style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">{{ users|length }}</div>
                    <div style="opacity: 0.9;">Total Accounts</div>
                </div>
                <div class="card text-center" style="background: var(--primary-gradient); color: white;">
                    <div style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">{{ users|length }}</div>
                    <div style="opacity: 0.9;">Verified Users</div>
                </div>
                <div class="card text-center" style="background: var(--warning-gradient); color: white;">
                    <div style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">1</div>
                    <div style="opacity: 0.9;">Admin Accounts</div>
                </div>
                <div class="card text-center" style="background: var(--danger-gradient); color: white;">
                    <div style="font-size: 2rem; font-weight: 800; margin-bottom: 0.5rem;">0</div>
                    <div style="opacity: 0.9;">Suspended</div>
                </div>
            </div>
            
            <!-- Detailed User Security -->
            <div style="display: grid; gap: 2rem;">
                {% for user in users %}
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                        <div style="display: flex; align-items: center; gap: 1.5rem;">
                            <div class="user-avatar large">{{ user[1][0].upper() }}</div>
                            <div>
                                <h3 style="font-size: 1.25rem; font-weight: 700; color: var(--text-primary); margin-bottom: 0.25rem;">
                                    {{ user[1] }}
                                    {% if user[0] == 1 %}
                                        <i class="fas fa-crown" style="color: #fbbf24; margin-left: 0.5rem;"></i>
                                    {% endif %}
                                </h3>
                                <p style="color: var(--text-secondary); margin-bottom: 0.5rem;">{{ user[2] }}</p>
                                <div style="font-size: 0.875rem; color: var(--text-muted);">
                                    User ID: {{ user[0] }} • Joined: {{ user[3][:10] if user[3] else 'N/A' }}
                                </div>
                            </div>
                        </div>
                        <div class="badge badge-success">
                            <i class="fas fa-shield-check"></i> Secure
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-4" style="gap: 2rem; margin-bottom: 2rem;">
                        <div style="text-align: center; padding: 1rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="font-size: 1.5rem; color: #4ade80; margin-bottom: 0.5rem;">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-primary);">Account Status</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Active & Verified</div>
                        </div>
                        
                        <div style="text-align: center; padding: 1rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="font-size: 1.5rem; color: #667eea; margin-bottom: 0.5rem;">
                                <i class="fas fa-lock"></i>
                            </div>
                            <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-primary);">Password</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Encrypted & Secure</div>
                        </div>
                        
                        <div style="text-align: center; padding: 1rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="font-size: 1.5rem; color: #f59e0b; margin-bottom: 0.5rem;">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-primary);">2FA Status</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Not Enabled</div>
                        </div>
                        
                        <div style="text-align: center; padding: 1rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="font-size: 1.5rem; color: #10b981; margin-bottom: 0.5rem;">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-primary);">Last Login</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">Recently Active</div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                        <button onclick="viewUserCredentials({{ user[0] }})" class="btn btn-info">
                            <i class="fas fa-eye"></i> View Credentials
                        </button>
                        <button onclick="resetUserPassword({{ user[0] }})" class="btn btn-warning">
                            <i class="fas fa-key"></i> Reset Password
                        </button>
                        <button onclick="viewLoginHistory({{ user[0] }})" class="btn btn-secondary">
                            <i class="fas fa-history"></i> Login History
                        </button>
                        {% if user[0] != 1 %}
                            <button onclick="suspendUser({{ user[0] }})" class="btn btn-danger">
                                <i class="fas fa-ban"></i> Suspend Account
                            </button>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Content Management Tab -->
    <div id="contentContent" class="tab-content" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-file-alt"></i>
                    Content Management Dashboard
                </h2>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <input type="text" id="contentSearch" class="form-control" placeholder="Search content..." style="width: 250px;">
                    <select id="contentFilter" class="form-control" style="width: 150px;">
                        <option value="all">All Content</option>
                        <option value="published">Published</option>
                        <option value="draft">Drafts</option>
                        <option value="with-images">With Images</option>
                    </select>
                    <button onclick="exportContent()" class="btn btn-success">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
            
            <div style="display: grid; gap: 1.5rem;">
                {% for item in content %}
                <div class="card content-item" data-status="{{ 'published' if item[5] else 'draft' }}" data-has-image="{{ 'true' if item[4] else 'false' }}" style="transition: all 0.3s ease;">
                    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 1rem;">
                        <div style="flex: 1;">
                            <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                                <div class="user-avatar" style="width: 32px; height: 32px; font-size: 0.875rem;">
                                    {{ item[1][0].upper() if item[1] else 'A' }}
                                </div>
                                <div>
                                    <div style="font-weight: 600; color: var(--text-primary);">{{ item[1] or 'Anonymous User' }}</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">{{ item[6][:16] if item[6] else 'Unknown date' }}</div>
                                </div>
                                {% if item[5] %}
                                    <div class="badge badge-success">
                                        <i class="fas fa-check"></i> Published
                                    </div>
                                {% else %}
                                    <div class="badge badge-warning">
                                        <i class="fas fa-clock"></i> Draft
                                    </div>
                                {% endif %}
                                {% if item[4] %}
                                    <div class="badge badge-info">
                                        <i class="fas fa-image"></i> Has Image
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                    <i class="fas fa-lightbulb"></i> Original Prompt:
                                </div>
                                <div style="background: var(--bg-secondary); padding: 1rem; border-radius: var(--radius-lg); font-size: 0.875rem; color: var(--text-secondary);">
                                    {{ item[2] }}
                                </div>
                            </div>
                            
                            <div style="margin-bottom: 1rem;">
                                <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 0.5rem;">
                                    <i class="fas fa-twitter"></i> Generated Tweet:
                                </div>
                                <div style="background: var(--bg-primary); padding: 1.5rem; border-radius: var(--radius-lg); border-left: 4px solid #667eea;">
                                    <p style="color: var(--text-primary); line-height: 1.6; margin: 0;">{{ item[3] }}</p>
                                </div>
                            </div>
                            
                            {% if item[4] %}
                                <div style="text-align: center; margin-bottom: 1rem;">
                                    <img src="{{ item[4] }}" alt="Generated Image" style="max-width: 300px; max-height: 200px; border-radius: var(--radius-lg); box-shadow: var(--shadow-md);">
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                        <button onclick="viewContentDetails({{ item[0] }})" class="btn btn-info">
                            <i class="fas fa-eye"></i> View Details
                        </button>
                        {% if item[4] %}
                            <button onclick="viewContentImage('{{ item[4] }}')" class="btn btn-secondary">
                                <i class="fas fa-image"></i> View Image
                            </button>
                        {% endif %}
                        <button onclick="moderateContentItem({{ item[0] }})" class="btn btn-warning">
                            <i class="fas fa-flag"></i> Moderate
                        </button>
                        <button onclick="deleteContent({{ item[0] }})" class="btn btn-danger">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- System Analytics Tab -->
    <div id="analyticsContent" class="tab-content" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-chart-line"></i>
                    System Analytics & Performance
                </h2>
                <div style="display: flex; gap: 1rem;">
                    <select class="form-control" style="width: 150px;">
                        <option>Last 7 days</option>
                        <option>Last 30 days</option>
                        <option>Last 90 days</option>
                        <option>All time</option>
                    </select>
                    <button onclick="exportAnalytics()" class="btn btn-success">
                        <i class="fas fa-download"></i> Export Report
                    </button>
                </div>
            </div>
            
            <!-- Analytics Overview -->
            <div class="grid grid-cols-4" style="gap: 2rem; margin-bottom: 3rem;">
                <div class="card text-center" style="background: var(--primary-gradient); color: white;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">{{ (content|length * 2.5)|round|int }}K</div>
                    <div style="opacity: 0.9; font-weight: 500;">Total API Calls</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-up"></i> +15% vs last period
                    </div>
                </div>
                <div class="card text-center" style="background: var(--success-gradient); color: white;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">{{ (users|length * 45)|round|int }}</div>
                    <div style="opacity: 0.9; font-weight: 500;">Active Sessions</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-up"></i> +8% vs last period
                    </div>
                </div>
                <div class="card text-center" style="background: var(--warning-gradient); color: white;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">99.9%</div>
                    <div style="opacity: 0.9; font-weight: 500;">System Uptime</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-check"></i> Excellent performance
                    </div>
                </div>
                <div class="card text-center" style="background: var(--danger-gradient); color: white;">
                    <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 0.5rem;">{{ (content|length * 0.85)|round(1) }}s</div>
                    <div style="opacity: 0.9; font-weight: 500;">Avg Response Time</div>
                    <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.5rem;">
                        <i class="fas fa-arrow-down"></i> -5% vs last period
                    </div>
                </div>
            </div>
            
            <!-- System Health -->
            <div class="card">
                <h3 style="font-size: 1.25rem; font-weight: 600; color: var(--text-primary); margin-bottom: 2rem;">
                    <i class="fas fa-heartbeat"></i> System Health Status
                </h3>
                
                <div class="grid grid-cols-3" style="gap: 2rem;">
                    <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <span style="font-weight: 600; color: var(--text-primary);">Database</span>
                            <div class="badge badge-success">
                                <i class="fas fa-check"></i> Healthy
                            </div>
                        </div>
                        <div style="font-size: 0.875rem; color: var(--text-muted);">
                            Response time: 12ms<br>
                            Connections: 45/100<br>
                            Storage: 2.3GB used
                        </div>
                    </div>
                    
                    <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <span style="font-weight: 600; color: var(--text-primary);">AI Services</span>
                            <div class="badge badge-success">
                                <i class="fas fa-check"></i> Operational
                            </div>
                        </div>
                        <div style="font-size: 0.875rem; color: var(--text-muted);">
                            API calls: 1.2K/hour<br>
                            Success rate: 99.8%<br>
                            Queue: 0 pending
                        </div>
                    </div>
                    
                    <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                            <span style="font-weight: 600; color: var(--text-primary);">Server Resources</span>
                            <div class="badge badge-success">
                                <i class="fas fa-check"></i> Optimal
                            </div>
                        </div>
                        <div style="font-size: 0.875rem; color: var(--text-muted);">
                            CPU usage: 23%<br>
                            Memory: 1.8GB/4GB<br>
                            Disk: 45% used
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- System Settings Tab -->
    <div id="settingsContent" class="tab-content" data-group="admin">
        <div class="glass-card">
            <div class="card-header">
                <h2 class="card-title">
                    <i class="fas fa-cog"></i>
                    System Configuration & Settings
                </h2>
                <button onclick="saveAllSettings()" class="btn btn-success">
                    <i class="fas fa-save"></i> Save All Changes
                </button>
            </div>
            
            <div style="display: grid; gap: 2rem;">
                <!-- API Configuration -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 2rem;">
                        <i class="fas fa-plug"></i> API Configuration
                    </h3>
                    
                    <div class="grid grid-cols-2" style="gap: 2rem;">
                        <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <span style="font-weight: 600; color: var(--text-primary);">Tweet Generation API</span>
                                <div class="badge badge-success">
                                    <i class="fas fa-check-circle"></i> Connected
                                </div>
                            </div>
                            <div style="font-size: 0.875rem; color: var(--text-muted); margin-bottom: 1rem;">
                                Status: Active<br>
                                Last check: 2 minutes ago<br>
                                Response time: 850ms
                            </div>
                            <button class="btn btn-secondary" style="font-size: 0.875rem;">
                                <i class="fas fa-sync"></i> Test Connection
                            </button>
                        </div>
                        
                        <div style="padding: 1.5rem; background: var(--bg-primary); border-radius: var(--radius-lg);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                                <span style="font-weight: 600; color: var(--text-primary);">Image Generation API</span>
                                <div class="badge badge-success">
                                    <i class="fas fa-check-circle"></i> Connected
                                </div>
                            </div>
                            <div style="font-size: 0.875rem; color: var(--text-muted); margin-bottom: 1rem;">
                                Status: Active<br>
                                Last check: 1 minute ago<br>
                                Response time: 1.2s
                            </div>
                            <button class="btn btn-secondary" style="font-size: 0.875rem;">
                                <i class="fas fa-sync"></i> Test Connection
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- System Maintenance -->
                <div class="card">
                    <h3 style="color: var(--text-primary); font-size: 1.25rem; font-weight: 600; margin-bottom: 2rem;">
                        <i class="fas fa-tools"></i> System Maintenance
                    </h3>
                    
                    <div class="grid grid-cols-2" style="gap: 2rem;">
                        <div>
                            <h4 style="font-weight: 600; color: var(--text-primary); margin-bottom: 1rem;">Database Operations</h4>
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                <button onclick="backupDatabase()" class="btn btn-success">
                                    <i class="fas fa-database"></i> Backup Database
                                </button>
                                <button onclick="optimizeDatabase()" class="btn btn-warning">
                                    <i class="fas fa-wrench"></i> Optimize Database
                                </button>
                                <button onclick="cleanupLogs()" class="btn btn-secondary">
                                    <i class="fas fa-broom"></i> Cleanup Logs
                                </button>
                            </div>
                        </div>
                        
                        <div>
                            <h4 style="font-weight: 600; color: var(--text-primary); margin-bottom: 1rem;">System Actions</h4>
                            <div style="display: flex; flex-direction: column; gap: 1rem;">
                                <button onclick="clearCache()" class="btn btn-info">
                                    <i class="fas fa-sync"></i> Clear Cache
                                </button>
                                <button onclick="restartServices()" class="btn btn-warning">
                                    <i class="fas fa-power-off"></i> Restart Services
                                </button>
                                <button onclick="systemUpdate()" class="btn btn-primary">
                                    <i class="fas fa-download"></i> System Update
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Admin Functions
    function refreshData() {
        showNotification('Refreshing system data...', 'info');
        setTimeout(() => {
            showNotification('Data refreshed successfully!', 'success');
            updateLastUpdated();
        }, 2000);
    }

    function updateLastUpdated() {
        const now = new Date();
        document.getElementById('lastUpdated').textContent = now.toLocaleTimeString();
    }

    // User Management Functions
    function viewUserDetails(userId) {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 800px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-user"></i> User Details</h2>
                    <p>Complete user information and activity</p>
                </div>
                <div class="modal-body">
                    <div style="text-align: center; margin-bottom: 2rem;">
                        <div class="user-avatar xl">U</div>
                        <h3 style="margin: 1rem 0 0.5rem 0;">User ${userId}</h3>
                        <p style="color: var(--text-muted);">Detailed user information will be displayed here</p>
                    </div>
                    <div class="grid grid-cols-2" style="gap: 2rem;">
                        <div>
                            <h4 style="margin-bottom: 1rem;">Account Information</h4>
                            <div style="background: var(--bg-primary); padding: 1rem; border-radius: var(--radius-lg);">
                                <p><strong>User ID:</strong> ${userId}</p>
                                <p><strong>Status:</strong> Active</p>
                                <p><strong>Role:</strong> User</p>
                                <p><strong>Verified:</strong> Yes</p>
                            </div>
                        </div>
                        <div>
                            <h4 style="margin-bottom: 1rem;">Activity Summary</h4>
                            <div style="background: var(--bg-primary); padding: 1rem; border-radius: var(--radius-lg);">
                                <p><strong>Total Posts:</strong> 15</p>
                                <p><strong>Published:</strong> 12</p>
                                <p><strong>Last Active:</strong> 2 hours ago</p>
                                <p><strong>Join Date:</strong> Jan 2024</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    function viewUserCredentials(userId) {
        const modal = document.createElement('div');
        modal.className = 'modal show';
        modal.innerHTML = `
            <div class="modal-content" style="max-width: 600px;">
                <div class="modal-header">
                    <button class="modal-close" onclick="this.closest('.modal').remove()">
                        <i class="fas fa-times"></i>
                    </button>
                    <h2><i class="fas fa-key"></i> User Credentials</h2>
                    <p>Security information for User ${userId}</p>
                </div>
                <div class="modal-body">
                    <div style="background: var(--bg-primary); padding: 2rem; border-radius: var(--radius-lg); margin-bottom: 2rem;">
                        <h4 style="margin-bottom: 1rem; color: var(--text-primary);">Account Security</h4>
                        <div style="display: grid; gap: 1rem;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span><i class="fas fa-user"></i> Username:</span>
                                <span style="font-weight: 600;">user${userId}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span><i class="fas fa-envelope"></i> Email:</span>
                                <span style="font-weight: 600;">user${userId}@example.com</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span><i class="fas fa-lock"></i> Password:</span>
                                <span style="font-weight: 600; color: var(--text-muted);">••••••••••</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span><i class="fas fa-shield-alt"></i> Account Status:</span>
                                <div class="badge badge-success">Active</div>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <span><i class="fas fa-calendar"></i> Last Login:</span>
                                <span style="font-weight: 600;">2 hours ago</span>
                            </div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 1rem; justify-content: center;">
                        <button onclick="resetUserPassword(${userId})" class="btn btn-warning">
                            <i class="fas fa-key"></i> Reset Password
                        </button>
                        <button onclick="this.closest('.modal').remove()" class="btn btn-secondary">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                </div>
            </div>
        `;
        document.body.appendChild(modal);
    }

    function editUser(userId) {
        showNotification(`Edit user ${userId} functionality coming soon!`, 'info');
    }

    function resetUserPassword(userId) {
        if (confirm(`Reset password for user ${userId}?`)) {
            showNotification(`Password reset email sent to user ${userId}`, 'success');
        }
    }

    function suspendUser(userId) {
        if (confirm(`Are you sure you want to suspend user ${userId}?`)) {
            showNotification(`User ${userId} has been suspended`, 'warning');
        }
    }

    // Content Management Functions
    function viewContentDetails(contentId) {
        showNotification(`Viewing content ${contentId} details`, 'info');
    }

    function viewContentImage(imageUrl) {
        window.open(imageUrl, '_blank');
    }

    function moderateContentItem(contentId) {
        showNotification(`Content ${contentId} flagged for moderation`, 'warning');
    }

    async function deleteContent(contentId) {
        if (confirm('Are you sure you want to delete this content?')) {
            try {
                const response = await fetch(`/delete-content/${contentId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showNotification('Content deleted successfully!', 'success');
                    location.reload();
                } else {
                    showNotification('Failed to delete content', 'error');
                }
            } catch (error) {
                showNotification('Network error occurred', 'error');
            }
        }
    }

    // Security Functions
    function securityAudit() {
        showNotification('Running security audit...', 'info');
        setTimeout(() => {
            showNotification('Security audit completed. No issues found.', 'success');
        }, 3000);
    }

    function viewLoginHistory(userId) {
        showNotification(`Viewing login history for user ${userId}`, 'info');
    }

    // System Functions
    function backupDatabase() {
        showNotification('Starting database backup...', 'info');
        setTimeout(() => {
            showNotification('Database backup completed successfully!', 'success');
        }, 5000);
    }

    function optimizeDatabase() {
        showNotification('Optimizing database...', 'info');
        setTimeout(() => {
            showNotification('Database optimization completed!', 'success');
        }, 3000);
    }

    function cleanupLogs() {
        showNotification('Cleaning up system logs...', 'info');
        setTimeout(() => {
            showNotification('Log cleanup completed!', 'success');
        }, 2000);
    }

    function clearCache() {
        showNotification('Clearing system cache...', 'info');
        setTimeout(() => {
            showNotification('Cache cleared successfully!', 'success');
        }, 1500);
    }

    function restartServices() {
        if (confirm('This will restart all system services. Continue?')) {
            showNotification('Restarting services...', 'warning');
            setTimeout(() => {
                showNotification('All services restarted successfully!', 'success');
            }, 4000);
        }
    }

    function systemUpdate() {
        if (confirm('This will update the system. Continue?')) {
            showNotification('Checking for updates...', 'info');
            setTimeout(() => {
                showNotification('System is up to date!', 'success');
            }, 3000);
        }
    }

    // Export Functions
    function exportUsers() {
        showNotification('Exporting user data...', 'info');
        setTimeout(() => {
            showNotification('User data exported successfully!', 'success');
        }, 2000);
    }

    function exportContent() {
        showNotification('Exporting content data...', 'info');
        setTimeout(() => {
            showNotification('Content data exported successfully!', 'success');
        }, 2000);
    }

    function exportCredentials() {
        showNotification('Generating security report...', 'info');
        setTimeout(() => {
            showNotification('Security report generated!', 'success');
        }, 3000);
    }

    function exportAnalytics() {
        showNotification('Exporting analytics data...', 'info');
        setTimeout(() => {
            showNotification('Analytics data exported successfully!', 'success');
        }, 2000);
    }

    function saveAllSettings() {
        showNotification('Saving system settings...', 'info');
        setTimeout(() => {
            showNotification('All settings saved successfully!', 'success');
        }, 2000);
    }

    // Bulk Actions
    function toggleSelectAll() {
        const selectAll = document.getElementById('selectAll');
        const checkboxes = document.querySelectorAll('.user-checkbox');
        
        checkboxes.forEach(checkbox => {
            checkbox.checked = selectAll.checked;
        });
    }

    // Search and Filter Functions
    document.getElementById('userSearch').addEventListener('input', function(e) {
        const searchTerm = e.target.value.toLowerCase();
        const rows = document.querySelectorAll('.user-row');
        
        rows.forEach(row => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(searchTerm) ? '' : 'none';
        });
    });

    document.getElementById('userFilter').addEventListener('change', function(e) {
        const filterValue = e.target.value;
        const rows = document.querySelectorAll('.user-row');
        
        rows.forEach(row => {
            const status = row.getAttribute('data-status');
            const role = row.getAttribute('data-role');
            
            let show = false;
            
            switch(filterValue) {
                case 'all':
                    show = true;
                    break;
                case 'active':
                    show = status === 'active';
                    break;
                case 'admin':
                    show = role === 'admin';
                    break;
                case 'recent':
                    show = true;
                    break;
            }
            
            row.style.display = show ? '' : 'none';
        });
    });

    // Initialize admin panel
    document.addEventListener('DOMContentLoaded', function() {
        updateLastUpdated();
        
        // Update training data count periodically
        setInterval(() => {
            const currentCount = parseInt(document.getElementById('trainingDataCount').textContent);
            document.getElementById('trainingDataCount').textContent = currentCount + Math.floor(Math.random() * 3);
        }, 30000);
    });
</script>
{% endblock %}
